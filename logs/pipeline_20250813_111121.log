2025-08-13 11:11:21,255 - INFO - Logging initialized. Log file: logs\pipeline_20250813_111121.log
2025-08-13 11:11:21,256 - INFO - ==================================================
2025-08-13 11:11:21,256 - INFO - Starting Veracore Data Pipeline
2025-08-13 11:11:21,256 - INFO - Execution time: 2025-08-13 11:11:21
2025-08-13 11:11:21,256 - INFO - ==================================================
2025-08-13 11:11:21,256 - INFO - All required environment variables are set.
2025-08-13 11:11:21,256 - INFO - Attempting to get authorization token from VeraCore API
2025-08-13 11:11:21,258 - INFO - USERNAME: SET
2025-08-13 11:11:21,258 - INFO - PASSWORD: SET
2025-08-13 11:11:21,258 - INFO - SYSTEM_ID: SET
2025-08-13 11:11:21,259 - INFO - W_TOKEN: SET
2025-08-13 11:11:21,259 - INFO - USERNAME value: jannatipour.leena
2025-08-13 11:11:21,259 - INFO - SYSTEM_ID value: 3plwhs
2025-08-13 11:11:21,259 - INFO - Attempting direct token authentication...
2025-08-13 11:11:21,259 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-13 11:11:21,838 - INFO - Direct token test - Status Code: 200
2025-08-13 11:11:21,839 - INFO - Direct token test - Response Headers: {'Date': 'Wed, 13 Aug 2025 18:11:22 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s2; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '96ea2cadde40337c-MIA'}
2025-08-13 11:11:21,839 - INFO - âœ“ Direct token authentication successful!
2025-08-13 11:11:21,839 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-13 11:11:22,082 - INFO - Skipping SharePoint upload for available_reports_endpoint.csv
2025-08-13 11:11:22,082 - INFO - Deleted local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\available_reports_endpoint.csv
2025-08-13 11:11:22,083 - INFO - Processing report 1/6: unit-details
2025-08-13 11:11:22,083 - INFO - Processing report: unit-details
2025-08-13 11:11:26,359 - INFO - Task started. Task ID: 57178
2025-08-13 11:11:26,630 - INFO - Report status: Processing (attempt 1)
2025-08-13 11:11:42,994 - INFO - Report status: Processing (attempt 6)
2025-08-13 11:11:51,866 - INFO - Report Completed
2025-08-13 11:11:55,524 - INFO - Report data saved to unit_details_with_current_balance.csv
2025-08-13 11:11:55,525 - INFO - Starting SharePoint upload process...
2025-08-13 11:11:55,525 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\unit_details_with_current_balance.csv
2025-08-13 11:11:55,525 - INFO - SharePoint filename: unit_details_with_current_balance_20250813_111155.csv
2025-08-13 11:11:55,525 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:11:55,525 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:11:57,262 - INFO - SharePoint authentication successful
2025-08-13 11:11:57,262 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:11:57,263 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:11:57,263 - INFO - Starting archiving process...
2025-08-13 11:11:57,263 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:11:57,263 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:11:57,263 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:11:57,417 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:11:57,417 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:11:57,417 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:11:57,418 - INFO - Archiving completed successfully
2025-08-13 11:11:57,718 - INFO - Uploading file: unit_details_with_current_balance_20250813_111155.csv
2025-08-13 11:12:00,174 - INFO - Successfully uploaded: unit_details_with_current_balance_20250813_111155.csv
2025-08-13 11:12:00,174 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/unit_details_with_current_balance_20250813_111155.csv
2025-08-13 11:12:00,175 - INFO - Successfully uploaded unit_details_with_current_balance.csv to SharePoint
2025-08-13 11:12:00,191 - INFO - Processing report 2/6: expected
2025-08-13 11:12:00,191 - INFO - Processing report: expected
2025-08-13 11:12:00,685 - INFO - Task started. Task ID: 57179
2025-08-13 11:12:00,898 - INFO - Report status: Processing (attempt 1)
2025-08-13 11:12:04,094 - INFO - Report Completed
2025-08-13 11:12:04,487 - INFO - Report data saved to expected_arrivals.csv
2025-08-13 11:12:04,487 - INFO - Starting SharePoint upload process...
2025-08-13 11:12:04,488 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\expected_arrivals.csv
2025-08-13 11:12:04,488 - INFO - SharePoint filename: expected_arrivals_20250813_111204.csv
2025-08-13 11:12:04,488 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:12:04,488 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:05,890 - INFO - SharePoint authentication successful
2025-08-13 11:12:05,890 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:05,890 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:05,890 - INFO - Starting archiving process...
2025-08-13 11:12:05,890 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:12:05,890 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:05,891 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:06,013 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:12:06,014 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:12:06,014 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:06,014 - INFO - Archiving completed successfully
2025-08-13 11:12:06,155 - INFO - Uploading file: expected_arrivals_20250813_111204.csv
2025-08-13 11:12:06,783 - INFO - Successfully uploaded: expected_arrivals_20250813_111204.csv
2025-08-13 11:12:06,783 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/expected_arrivals_20250813_111204.csv
2025-08-13 11:12:06,783 - INFO - Successfully uploaded expected_arrivals.csv to SharePoint
2025-08-13 11:12:06,784 - INFO - Processing report 3/6: Unit Billing
2025-08-13 11:12:06,784 - INFO - Processing report: Unit Billing
2025-08-13 11:12:07,174 - INFO - Task started. Task ID: 57180
2025-08-13 11:12:07,474 - INFO - Report status: Created (attempt 1)
2025-08-13 11:12:10,829 - INFO - Report Completed
2025-08-13 11:12:11,124 - INFO - Report data saved to unit_billing.csv
2025-08-13 11:12:11,125 - INFO - Starting SharePoint upload process...
2025-08-13 11:12:11,125 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\unit_billing.csv
2025-08-13 11:12:11,125 - INFO - SharePoint filename: unit_billing_20250813_111211.csv
2025-08-13 11:12:11,125 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:12:11,125 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:12,372 - INFO - SharePoint authentication successful
2025-08-13 11:12:12,372 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:12,372 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:12,373 - INFO - Starting archiving process...
2025-08-13 11:12:12,373 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:12:12,373 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:12,374 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:12,485 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:12:12,485 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:12:12,486 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:12,486 - INFO - Archiving completed successfully
2025-08-13 11:12:12,601 - INFO - Uploading file: unit_billing_20250813_111211.csv
2025-08-13 11:12:13,057 - INFO - Successfully uploaded: unit_billing_20250813_111211.csv
2025-08-13 11:12:13,058 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/unit_billing_20250813_111211.csv
2025-08-13 11:12:13,058 - INFO - Successfully uploaded unit_billing.csv to SharePoint
2025-08-13 11:12:13,059 - INFO - Processing report 4/6: WarehouseLocations
2025-08-13 11:12:13,059 - INFO - Processing report: WarehouseLocations
2025-08-13 11:12:13,682 - INFO - Task started. Task ID: 57181
2025-08-13 11:12:13,882 - INFO - Report status: Created (attempt 1)
2025-08-13 11:12:17,070 - INFO - Report Completed
2025-08-13 11:12:18,137 - INFO - Report data saved to warehouse_locations.csv
2025-08-13 11:12:18,137 - INFO - Starting SharePoint upload process...
2025-08-13 11:12:18,137 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\warehouse_locations.csv
2025-08-13 11:12:18,138 - INFO - SharePoint filename: warehouse_locations_20250813_111218.csv
2025-08-13 11:12:18,138 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:12:18,138 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:19,265 - INFO - SharePoint authentication successful
2025-08-13 11:12:19,265 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:19,265 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:19,266 - INFO - Starting archiving process...
2025-08-13 11:12:19,266 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:12:19,266 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:19,266 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:19,377 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:12:19,378 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:12:19,378 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:19,378 - INFO - Archiving completed successfully
2025-08-13 11:12:19,494 - INFO - Uploading file: warehouse_locations_20250813_111218.csv
2025-08-13 11:12:20,127 - INFO - Successfully uploaded: warehouse_locations_20250813_111218.csv
2025-08-13 11:12:20,127 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/warehouse_locations_20250813_111218.csv
2025-08-13 11:12:20,128 - INFO - Successfully uploaded warehouse_locations.csv to SharePoint
2025-08-13 11:12:20,131 - INFO - Processing report 5/6: Shipping Report
2025-08-13 11:12:20,131 - INFO - Processing report: Shipping Report
2025-08-13 11:12:20,401 - INFO - Task started. Task ID: 57182
2025-08-13 11:12:20,724 - INFO - Report status: Created (attempt 1)
2025-08-13 11:12:33,658 - INFO - Report Completed
2025-08-13 11:12:34,837 - INFO - Report data saved to shipping_report.csv
2025-08-13 11:12:34,838 - INFO - Starting SharePoint upload process...
2025-08-13 11:12:34,838 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\shipping_report.csv
2025-08-13 11:12:34,838 - INFO - SharePoint filename: shipping_report_20250813_111234.csv
2025-08-13 11:12:34,838 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:12:34,839 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:36,778 - INFO - SharePoint authentication successful
2025-08-13 11:12:36,778 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:36,778 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:36,779 - INFO - Starting archiving process...
2025-08-13 11:12:36,779 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:12:36,779 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:36,779 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:36,931 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:12:36,931 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:12:36,931 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:36,931 - INFO - Archiving completed successfully
2025-08-13 11:12:37,050 - INFO - Uploading file: shipping_report_20250813_111234.csv
2025-08-13 11:12:37,744 - INFO - Successfully uploaded: shipping_report_20250813_111234.csv
2025-08-13 11:12:37,744 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/shipping_report_20250813_111234.csv
2025-08-13 11:12:37,745 - INFO - Successfully uploaded shipping_report.csv to SharePoint
2025-08-13 11:12:37,750 - INFO - Processing report 6/6: Pull Manifest report
2025-08-13 11:12:37,750 - INFO - Processing report: Pull Manifest report
2025-08-13 11:12:38,180 - INFO - Task started. Task ID: 57183
2025-08-13 11:12:38,453 - INFO - Report status: Created (attempt 1)
2025-08-13 11:12:41,844 - INFO - Report Completed
2025-08-13 11:12:43,804 - INFO - Report data saved to pull_manifest_report.csv
2025-08-13 11:12:43,805 - INFO - Starting SharePoint upload process...
2025-08-13 11:12:43,805 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250813_111121\pull_manifest_report.csv
2025-08-13 11:12:43,805 - INFO - SharePoint filename: pull_manifest_report_20250813_111243.csv
2025-08-13 11:12:43,805 - INFO - SharePoint URL: https://3plwinner.sharepoint.com
2025-08-13 11:12:43,806 - INFO - SharePoint folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:45,351 - INFO - SharePoint authentication successful
2025-08-13 11:12:45,351 - INFO - Clean folder path: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:45,351 - INFO - Archive folder path: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:45,352 - INFO - Starting archiving process...
2025-08-13 11:12:45,352 - INFO - ARCHIVE DEBUG: Starting archive process
2025-08-13 11:12:45,352 - INFO - ARCHIVE DEBUG: Source folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:45,352 - INFO - ARCHIVE DEBUG: Archive folder: /Shared%20Documents/InventoryHealthDashboard/Archive
2025-08-13 11:12:45,508 - INFO - ARCHIVE DEBUG: All files found: []
2025-08-13 11:12:45,509 - INFO - ARCHIVE DEBUG: CSV files to archive: []
2025-08-13 11:12:45,509 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-13 11:12:45,509 - INFO - Archiving completed successfully
2025-08-13 11:12:45,642 - INFO - Uploading file: pull_manifest_report_20250813_111243.csv
2025-08-13 11:12:46,990 - INFO - Successfully uploaded: pull_manifest_report_20250813_111243.csv
2025-08-13 11:12:46,990 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/pull_manifest_report_20250813_111243.csv
2025-08-13 11:12:46,990 - INFO - Successfully uploaded pull_manifest_report.csv to SharePoint
2025-08-13 11:12:46,997 - INFO - ==================================================
2025-08-13 11:12:46,997 - INFO - Pipeline Summary:
2025-08-13 11:12:46,997 - INFO - Successful reports: 6 / 6
2025-08-13 11:12:46,998 - INFO - Completed at: 2025-08-13 11:12:46
2025-08-13 11:12:46,998 - INFO - ==================================================
2025-08-13 11:12:46,998 - INFO - Pipeline Completed Successfully
