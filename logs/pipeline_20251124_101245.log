2025-11-24 10:12:45,624 - INFO - Logging initialized. Log file: logs\pipeline_20251124_101245.log
2025-11-24 10:12:45,625 - INFO - ==================================================
2025-11-24 10:12:45,625 - INFO - Starting Veracore Data Pipeline
2025-11-24 10:12:45,625 - INFO - Execution time: 2025-11-24 10:12:45
2025-11-24 10:12:45,625 - INFO - ==================================================
2025-11-24 10:12:45,625 - INFO - All required environment variables are set.
2025-11-24 10:12:45,625 - INFO - ==================================================
2025-11-24 10:12:45,625 - INFO - ARCHIVING EXISTING CSV FILES
2025-11-24 10:12:45,626 - INFO - ==================================================
2025-11-24 10:12:45,626 - INFO - ARCHIVE: SHAREPOINT_URL = https://3plwinner.sharepoint.com
2025-11-24 10:12:45,626 - INFO - ARCHIVE: SHAREPOINT_FOLDER = /Shared Documents/InventoryHealthDashboard
2025-11-24 10:12:45,626 - INFO - ARCHIVE: SHAREPOINT_CLIENT_ID = SET
2025-11-24 10:12:45,626 - INFO - ARCHIVE: SHAREPOINT_CLIENT_SECRET = SET
2025-11-24 10:12:45,626 - INFO - ARCHIVE: Starting archive process for folder: /Shared Documents/InventoryHealthDashboard
2025-11-24 10:12:46,505 - INFO - ARCHIVE: Connected to site: 3PLWinner
2025-11-24 10:12:47,131 - INFO - ARCHIVE: Folder exists: True
2025-11-24 10:12:47,131 - INFO - ARCHIVE: Folder ServerRelativeUrl: /Shared Documents/InventoryHealthDashboard
2025-11-24 10:12:47,131 - INFO - ARCHIVE: Number of subfolders: 0
2025-11-24 10:12:47,132 - INFO - ARCHIVE: Files collection type: <class 'office365.sharepoint.files.file_collection.FileCollection'>
2025-11-24 10:12:47,132 - INFO - ARCHIVE: Files collection length: 0
2025-11-24 10:12:47,132 - INFO - ARCHIVE: Total files enumerated: 0
2025-11-24 10:12:47,132 - INFO - ARCHIVE: Attempting alternative method using list items...
2025-11-24 10:12:47,133 - ERROR - ARCHIVE: List method failed: No module named 'office365.sharepoint.caml_query'
2025-11-24 10:12:47,133 - INFO - ARCHIVE: No CSV files to archive
2025-11-24 10:12:47,133 - INFO - ==================================================
2025-11-24 10:12:47,133 - INFO - ARCHIVING COMPLETED SUCCESSFULLY
2025-11-24 10:12:47,134 - INFO - ==================================================
2025-11-24 10:12:47,134 - INFO - Attempting to get authorization token from VeraCore API
2025-11-24 10:12:47,134 - INFO - USERNAME: SET
2025-11-24 10:12:47,134 - INFO - PASSWORD: SET
2025-11-24 10:12:47,134 - INFO - SYSTEM_ID: SET
2025-11-24 10:12:47,134 - INFO - W_TOKEN: SET
2025-11-24 10:12:47,135 - INFO - USERNAME value: jannatipour.leena
2025-11-24 10:12:47,135 - INFO - SYSTEM_ID value: 3plwhs
2025-11-24 10:12:47,135 - INFO - Attempting direct token authentication...
2025-11-24 10:12:47,135 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-11-24 10:12:48,530 - INFO - Direct token test - Status Code: 200
2025-11-24 10:12:48,531 - INFO - Direct token test - Response Headers: {'Date': 'Mon, 24 Nov 2025 18:12:48 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s1; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '9a3ae0660ac8ce98-SJC'}
2025-11-24 10:12:48,532 - INFO - âœ“ Direct token authentication successful!
2025-11-24 10:12:48,536 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-11-24 10:12:49,778 - INFO - Skipping SharePoint upload for available_reports_endpoint.csv
2025-11-24 10:12:49,779 - INFO - Deleted local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\available_reports_endpoint.csv
2025-11-24 10:12:49,780 - INFO - Processing report 1/9: unit-details
2025-11-24 10:12:49,780 - INFO - Processing report: unit-details
2025-11-24 10:13:02,700 - INFO - Task started. Task ID: 58647
2025-11-24 10:13:02,949 - INFO - Report status: Created (attempt 1)
2025-11-24 10:13:16,036 - INFO - Report Completed
2025-11-24 10:13:18,017 - INFO - Report data saved to unit_details_with_current_balance.csv
2025-11-24 10:13:18,018 - INFO - Starting SharePoint upload process...
2025-11-24 10:13:18,018 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\unit_details_with_current_balance.csv
2025-11-24 10:13:18,018 - INFO - SharePoint filename: unit_details_with_current_balance_20251124_101318.csv
2025-11-24 10:13:18,018 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:13:18,823 - INFO - Uploading file: unit_details_with_current_balance_20251124_101318.csv
2025-11-24 10:13:20,765 - INFO - Successfully uploaded: unit_details_with_current_balance_20251124_101318.csv
2025-11-24 10:13:20,765 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/unit_details_with_current_balance_20251124_101318.csv
2025-11-24 10:13:20,766 - INFO - Successfully uploaded unit_details_with_current_balance.csv to SharePoint
2025-11-24 10:13:20,769 - INFO - Processing report 2/9: returns-products
2025-11-24 10:13:20,769 - INFO - Processing report: returns-products
2025-11-24 10:13:25,054 - INFO - Task started. Task ID: 58648
2025-11-24 10:13:25,325 - INFO - Report status: Created (attempt 1)
2025-11-24 10:13:28,553 - INFO - Report Completed
2025-11-24 10:13:28,905 - INFO - Report data saved to returns.csv
2025-11-24 10:13:28,905 - INFO - Starting SharePoint upload process...
2025-11-24 10:13:28,905 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\returns.csv
2025-11-24 10:13:28,905 - INFO - SharePoint filename: returns_20251124_101328.csv
2025-11-24 10:13:28,906 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:13:29,675 - INFO - Uploading file: returns_20251124_101328.csv
2025-11-24 10:13:30,273 - INFO - Successfully uploaded: returns_20251124_101328.csv
2025-11-24 10:13:30,273 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/returns_20251124_101328.csv
2025-11-24 10:13:30,273 - INFO - Successfully uploaded returns.csv to SharePoint
2025-11-24 10:13:30,274 - INFO - Processing report 3/9: expectedd-all
2025-11-24 10:13:30,274 - INFO - Processing report: expectedd-all
2025-11-24 10:13:30,689 - INFO - Task started. Task ID: 58649
2025-11-24 10:13:30,927 - INFO - Report status: Created (attempt 1)
2025-11-24 10:13:47,087 - INFO - Report status: Processing (attempt 6)
2025-11-24 10:14:03,225 - INFO - Report status: Processing (attempt 11)
2025-11-24 10:14:09,783 - INFO - Report Completed
2025-11-24 10:14:12,501 - INFO - Report data saved to expected_arrivals.csv
2025-11-24 10:14:12,501 - INFO - Starting SharePoint upload process...
2025-11-24 10:14:12,502 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\expected_arrivals.csv
2025-11-24 10:14:12,502 - INFO - SharePoint filename: expected_arrivals_20251124_101412.csv
2025-11-24 10:14:12,502 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:14:13,077 - INFO - Uploading file: expected_arrivals_20251124_101412.csv
2025-11-24 10:14:16,372 - INFO - Successfully uploaded: expected_arrivals_20251124_101412.csv
2025-11-24 10:14:16,372 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/expected_arrivals_20251124_101412.csv
2025-11-24 10:14:16,373 - INFO - Successfully uploaded expected_arrivals.csv to SharePoint
2025-11-24 10:14:16,381 - INFO - Processing report 4/9: unit-billing
2025-11-24 10:14:16,381 - INFO - Processing report: unit-billing
2025-11-24 10:14:17,429 - INFO - Task started. Task ID: 58650
2025-11-24 10:14:17,736 - INFO - Report status: Created (attempt 1)
2025-11-24 10:14:33,962 - INFO - Report status: Processing (attempt 6)
2025-11-24 10:14:40,423 - INFO - Report Completed
2025-11-24 10:14:41,906 - INFO - Report data saved to unit_billing.csv
2025-11-24 10:14:41,907 - INFO - Starting SharePoint upload process...
2025-11-24 10:14:41,907 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\unit_billing.csv
2025-11-24 10:14:41,907 - INFO - SharePoint filename: unit_billing_20251124_101441.csv
2025-11-24 10:14:41,907 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:14:42,901 - INFO - Uploading file: unit_billing_20251124_101441.csv
2025-11-24 10:14:44,766 - INFO - Successfully uploaded: unit_billing_20251124_101441.csv
2025-11-24 10:14:44,766 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/unit_billing_20251124_101441.csv
2025-11-24 10:14:44,766 - INFO - Successfully uploaded unit_billing.csv to SharePoint
2025-11-24 10:14:44,771 - INFO - Processing report 5/9: WarehouseLocations
2025-11-24 10:14:44,771 - INFO - Processing report: WarehouseLocations
2025-11-24 10:14:45,084 - INFO - Task started. Task ID: 58651
2025-11-24 10:14:45,270 - INFO - Report status: Created (attempt 1)
2025-11-24 10:14:48,502 - INFO - Report Completed
2025-11-24 10:14:50,126 - INFO - Report data saved to warehouse_locations.csv
2025-11-24 10:14:50,127 - INFO - Starting SharePoint upload process...
2025-11-24 10:14:50,127 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\warehouse_locations.csv
2025-11-24 10:14:50,127 - INFO - SharePoint filename: warehouse_locations_20251124_101450.csv
2025-11-24 10:14:50,127 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:14:50,773 - INFO - Uploading file: warehouse_locations_20251124_101450.csv
2025-11-24 10:14:51,920 - INFO - Successfully uploaded: warehouse_locations_20251124_101450.csv
2025-11-24 10:14:51,920 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/warehouse_locations_20251124_101450.csv
2025-11-24 10:14:51,920 - INFO - Successfully uploaded warehouse_locations.csv to SharePoint
2025-11-24 10:14:51,922 - INFO - Processing report 6/9: Shipping Report
2025-11-24 10:14:51,923 - INFO - Processing report: Shipping Report
2025-11-24 10:14:52,313 - INFO - Task started. Task ID: 58652
2025-11-24 10:14:52,522 - INFO - Report status: Created (attempt 1)
2025-11-24 10:15:02,457 - INFO - Report Completed
2025-11-24 10:15:04,224 - INFO - Report data saved to shipping_report.csv
2025-11-24 10:15:04,224 - INFO - Starting SharePoint upload process...
2025-11-24 10:15:04,225 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\shipping_report.csv
2025-11-24 10:15:04,225 - INFO - SharePoint filename: shipping_report_20251124_101504.csv
2025-11-24 10:15:04,225 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:15:04,882 - INFO - Uploading file: shipping_report_20251124_101504.csv
2025-11-24 10:15:06,545 - INFO - Successfully uploaded: shipping_report_20251124_101504.csv
2025-11-24 10:15:06,545 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/shipping_report_20251124_101504.csv
2025-11-24 10:15:06,546 - INFO - Successfully uploaded shipping_report.csv to SharePoint
2025-11-24 10:15:06,551 - INFO - Processing report 7/9: Pull Manifest report
2025-11-24 10:15:06,552 - INFO - Processing report: Pull Manifest report
2025-11-24 10:15:06,927 - INFO - Task started. Task ID: 58653
2025-11-24 10:15:07,180 - INFO - Report status: Created (attempt 1)
2025-11-24 10:15:13,733 - INFO - Report Completed
2025-11-24 10:15:16,836 - INFO - Report data saved to pull_manifest_report.csv
2025-11-24 10:15:16,837 - INFO - Starting SharePoint upload process...
2025-11-24 10:15:16,837 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\pull_manifest_report.csv
2025-11-24 10:15:16,837 - INFO - SharePoint filename: pull_manifest_report_20251124_101516.csv
2025-11-24 10:15:16,837 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:15:17,351 - INFO - Uploading file: pull_manifest_report_20251124_101516.csv
2025-11-24 10:15:19,639 - INFO - Successfully uploaded: pull_manifest_report_20251124_101516.csv
2025-11-24 10:15:19,639 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/pull_manifest_report_20251124_101516.csv
2025-11-24 10:15:19,640 - INFO - Successfully uploaded pull_manifest_report.csv to SharePoint
2025-11-24 10:15:19,648 - INFO - Processing report 8/9: pickslip_activity
2025-11-24 10:15:19,648 - INFO - Processing report: pickslip_activity
2025-11-24 10:15:19,969 - INFO - Task started. Task ID: 58654
2025-11-24 10:15:20,249 - INFO - Report status: Created (attempt 1)
2025-11-24 10:15:23,524 - INFO - Report Completed
2025-11-24 10:15:23,810 - INFO - Report data saved to pickslip_activity.csv
2025-11-24 10:15:23,810 - INFO - Starting SharePoint upload process...
2025-11-24 10:15:23,810 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\pickslip_activity.csv
2025-11-24 10:15:23,810 - INFO - SharePoint filename: pickslip_activity_20251124_101523.csv
2025-11-24 10:15:23,811 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:15:24,334 - INFO - Uploading file: pickslip_activity_20251124_101523.csv
2025-11-24 10:15:24,946 - INFO - Successfully uploaded: pickslip_activity_20251124_101523.csv
2025-11-24 10:15:24,946 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/pickslip_activity_20251124_101523.csv
2025-11-24 10:15:24,946 - INFO - Successfully uploaded pickslip_activity.csv to SharePoint
2025-11-24 10:15:24,947 - INFO - Processing report 9/9: exceptions
2025-11-24 10:15:24,947 - INFO - Processing report: exceptions
2025-11-24 10:15:25,331 - INFO - Task started. Task ID: 58655
2025-11-24 10:15:25,548 - INFO - Report status: Created (attempt 1)
2025-11-24 10:15:28,754 - INFO - Report Completed
2025-11-24 10:15:29,116 - INFO - Report data saved to pickslip_exceptions.csv
2025-11-24 10:15:29,116 - INFO - Starting SharePoint upload process...
2025-11-24 10:15:29,116 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\output_20251124_101245\pickslip_exceptions.csv
2025-11-24 10:15:29,116 - INFO - SharePoint filename: pickslip_exceptions_20251124_101529.csv
2025-11-24 10:15:29,116 - INFO - SharePoint Client Credential authentication successful
2025-11-24 10:15:29,715 - INFO - Uploading file: pickslip_exceptions_20251124_101529.csv
2025-11-24 10:15:30,379 - INFO - Successfully uploaded: pickslip_exceptions_20251124_101529.csv
2025-11-24 10:15:30,380 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/InventoryHealthDashboard/pickslip_exceptions_20251124_101529.csv
2025-11-24 10:15:30,380 - INFO - Successfully uploaded pickslip_exceptions.csv to SharePoint
2025-11-24 10:15:30,381 - INFO - ==================================================
2025-11-24 10:15:30,381 - INFO - Pipeline Summary:
2025-11-24 10:15:30,381 - INFO - Successful reports: 9 / 9
2025-11-24 10:15:30,381 - INFO - Completed at: 2025-11-24 10:15:30
2025-11-24 10:15:30,381 - INFO - ==================================================
2025-11-24 10:15:30,381 - INFO - Pipeline Completed Successfully
