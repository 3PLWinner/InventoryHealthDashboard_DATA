2025-08-12 11:33:48,993 - INFO - Logging initialized. Log file: logs\pipeline_20250812_113348.log
2025-08-12 11:33:48,994 - INFO - ==================================================
2025-08-12 11:33:48,994 - INFO - Starting Veracore Data Pipeline
2025-08-12 11:33:48,994 - INFO - Execution time: 2025-08-12 11:33:48
2025-08-12 11:33:48,994 - INFO - ==================================================
2025-08-12 11:33:48,994 - INFO - All required environment variables are set.
2025-08-12 11:33:48,994 - INFO - Attempting to get authorization token from VeraCore API
2025-08-12 11:33:48,997 - INFO - USERNAME: SET
2025-08-12 11:33:48,997 - INFO - PASSWORD: SET
2025-08-12 11:33:48,997 - INFO - SYSTEM_ID: SET
2025-08-12 11:33:48,997 - INFO - W_TOKEN: SET
2025-08-12 11:33:48,997 - INFO - USERNAME value: jannatipour.leena
2025-08-12 11:33:48,998 - INFO - SYSTEM_ID value: 3plwhs
2025-08-12 11:33:48,998 - INFO - Attempting direct token authentication...
2025-08-12 11:33:48,998 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-12 11:33:49,347 - INFO - Direct token test - Status Code: 200
2025-08-12 11:33:49,347 - INFO - Direct token test - Response Headers: {'Date': 'Tue, 12 Aug 2025 18:33:49 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s1; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '96e210346c5c14dc-LAX'}
2025-08-12 11:33:49,351 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-12 11:33:49,673 - INFO - Skipping SharePoint upload for available_reports_endpoint.csv
2025-08-12 11:33:49,673 - INFO - Deleted local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250812_113348\available_reports_endpoint.csv
2025-08-12 11:33:49,674 - INFO - Processing report 1/5: Unit Details (by owner) with Current Balance
2025-08-12 11:33:49,674 - INFO - Processing report: Unit Details (by owner) with Current Balance
2025-08-12 11:33:50,105 - INFO - Task started. Task ID: 57151
2025-08-12 11:33:50,401 - INFO - Report status: Created (attempt 1)
2025-08-12 11:33:56,867 - INFO - Report Completed
2025-08-12 11:33:57,593 - INFO - Report data saved to unit_details_with_current_balance.csv
2025-08-12 11:34:00,009 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 11:34:00,964 - INFO - Successfully uploaded: unit_details_with_current_balance_20250812_113357.csv
2025-08-12 11:34:00,964 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/unit_details_with_current_balance_20250812_113357.csv
2025-08-12 11:34:00,965 - INFO - Successfully uploaded unit_details_with_current_balance.csv to SharePoint
2025-08-12 11:34:00,967 - INFO - Processing report 2/5: expected arrivals
2025-08-12 11:34:00,967 - INFO - Processing report: expected arrivals
2025-08-12 11:34:01,541 - INFO - Task started. Task ID: 57152
2025-08-12 11:34:01,865 - INFO - Report status: Created (attempt 1)
2025-08-12 11:34:05,146 - INFO - Report Completed
2025-08-12 11:34:05,471 - INFO - Report data saved to expected_arrivals.csv
2025-08-12 11:34:07,410 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 11:34:08,276 - INFO - Successfully uploaded: expected_arrivals_20250812_113405.csv
2025-08-12 11:34:08,276 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/expected_arrivals_20250812_113405.csv
2025-08-12 11:34:08,276 - INFO - Successfully uploaded expected_arrivals.csv to SharePoint
2025-08-12 11:34:08,277 - INFO - Processing report 3/5: WarehouseLocations
2025-08-12 11:34:08,277 - INFO - Processing report: WarehouseLocations
2025-08-12 11:34:08,962 - INFO - Task started. Task ID: 57153
2025-08-12 11:34:09,168 - INFO - Report status: Processing (attempt 1)
2025-08-12 11:34:12,454 - INFO - Report Completed
2025-08-12 11:34:13,588 - INFO - Report data saved to warehouse_locations.csv
2025-08-12 11:34:15,816 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 11:34:16,666 - INFO - Successfully uploaded: warehouse_locations_20250812_113413.csv
2025-08-12 11:34:16,666 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/warehouse_locations_20250812_113413.csv
2025-08-12 11:34:16,666 - INFO - Successfully uploaded warehouse_locations.csv to SharePoint
2025-08-12 11:34:16,669 - INFO - Processing report 4/5: Shipping Report
2025-08-12 11:34:16,669 - INFO - Processing report: Shipping Report
2025-08-12 11:34:17,075 - INFO - Task started. Task ID: 57154
2025-08-12 11:34:17,370 - INFO - Report status: Created (attempt 1)
2025-08-12 11:34:27,090 - INFO - Report Completed
2025-08-12 11:34:28,375 - INFO - Report data saved to shipping_report.csv
2025-08-12 11:34:30,212 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 11:34:31,189 - INFO - Successfully uploaded: shipping_report_20250812_113428.csv
2025-08-12 11:34:31,189 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/shipping_report_20250812_113428.csv
2025-08-12 11:34:31,190 - INFO - Successfully uploaded shipping_report.csv to SharePoint
2025-08-12 11:34:31,197 - INFO - Processing report 5/5: Pull Manifest report
2025-08-12 11:34:31,198 - INFO - Processing report: Pull Manifest report
2025-08-12 11:34:31,629 - INFO - Task started. Task ID: 57155
2025-08-12 11:34:31,887 - INFO - Report status: Created (attempt 1)
2025-08-12 11:34:38,415 - INFO - Report Completed
2025-08-12 11:34:40,237 - INFO - Report data saved to pull_manifest_report.csv
2025-08-12 11:34:41,869 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 11:34:43,436 - INFO - Successfully uploaded: pull_manifest_report_20250812_113440.csv
2025-08-12 11:34:43,436 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/pull_manifest_report_20250812_113440.csv
2025-08-12 11:34:43,437 - INFO - Successfully uploaded pull_manifest_report.csv to SharePoint
2025-08-12 11:34:43,443 - INFO - ==================================================
2025-08-12 11:34:43,443 - INFO - Pipeline Summary:
2025-08-12 11:34:43,444 - INFO - Successful reports: 5 / 5
2025-08-12 11:34:43,444 - INFO - Completed at: 2025-08-12 11:34:43
2025-08-12 11:34:43,444 - INFO - ==================================================
2025-08-12 11:34:43,444 - INFO - Pipeline Completed Successfully
