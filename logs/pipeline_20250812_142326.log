2025-08-12 14:23:26,746 - INFO - Logging initialized. Log file: logs\pipeline_20250812_142326.log
2025-08-12 14:23:26,747 - INFO - ==================================================
2025-08-12 14:23:26,747 - INFO - Starting Veracore Data Pipeline
2025-08-12 14:23:26,747 - INFO - Execution time: 2025-08-12 14:23:26
2025-08-12 14:23:26,747 - INFO - ==================================================
2025-08-12 14:23:26,747 - INFO - All required environment variables are set.
2025-08-12 14:23:26,748 - INFO - Attempting to get authorization token from VeraCore API
2025-08-12 14:23:26,748 - INFO - USERNAME: SET
2025-08-12 14:23:26,748 - INFO - PASSWORD: SET
2025-08-12 14:23:26,748 - INFO - SYSTEM_ID: SET
2025-08-12 14:23:26,748 - INFO - W_TOKEN: SET
2025-08-12 14:23:26,748 - INFO - USERNAME value: jannatipour.leena
2025-08-12 14:23:26,749 - INFO - SYSTEM_ID value: 3plwhs
2025-08-12 14:23:26,749 - INFO - Attempting direct token authentication...
2025-08-12 14:23:26,749 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-12 14:23:27,096 - INFO - Direct token test - Status Code: 200
2025-08-12 14:23:27,097 - INFO - Direct token test - Response Headers: {'Date': 'Tue, 12 Aug 2025 21:23:27 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s1; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '96e308af68151686-SJC'}
2025-08-12 14:23:27,100 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-08-12 14:23:27,560 - INFO - Skipping SharePoint upload for available_reports_endpoint.csv
2025-08-12 14:23:27,561 - INFO - Deleted local file: C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-3\output_20250812_142326\available_reports_endpoint.csv
2025-08-12 14:23:27,561 - INFO - Processing report 1/6: unit-details
2025-08-12 14:23:27,561 - INFO - Processing report: unit-details
2025-08-12 14:23:27,940 - INFO - Task started. Task ID: 57163
2025-08-12 14:23:28,211 - INFO - Report status: Processing (attempt 1)
2025-08-12 14:23:44,408 - INFO - Report status: Processing (attempt 6)
2025-08-12 14:23:47,676 - INFO - Report Completed
2025-08-12 14:23:51,747 - INFO - Report data saved to unit_details_with_current_balance.csv
2025-08-12 14:23:53,691 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 14:23:56,014 - INFO - Successfully uploaded: unit_details_with_current_balance_20250812_142351.csv
2025-08-12 14:23:56,014 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/unit_details_with_current_balance_20250812_142351.csv
2025-08-12 14:23:56,015 - INFO - Successfully uploaded unit_details_with_current_balance.csv to SharePoint
2025-08-12 14:23:56,031 - INFO - Processing report 2/6: expected arrivals
2025-08-12 14:23:56,032 - INFO - Processing report: expected arrivals
2025-08-12 14:23:56,473 - INFO - Task started. Task ID: 57164
2025-08-12 14:23:56,752 - INFO - Report status: Created (attempt 1)
2025-08-12 14:23:59,959 - INFO - Report Completed
2025-08-12 14:24:00,264 - INFO - Report data saved to expected_arrivals.csv
2025-08-12 14:24:01,980 - INFO - No CSV files to archive in folder: /Shared%20Documents/InventoryHealthDashboard
2025-08-12 14:24:02,548 - INFO - Successfully uploaded: expected_arrivals_20250812_142400.csv
2025-08-12 14:24:02,548 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared%20Documents/InventoryHealthDashboard/expected_arrivals_20250812_142400.csv
2025-08-12 14:24:02,549 - INFO - Successfully uploaded expected_arrivals.csv to SharePoint
2025-08-12 14:24:02,549 - INFO - Processing report 3/6: Unit Billing
2025-08-12 14:24:02,549 - INFO - Processing report: Unit Billing
2025-08-12 14:24:03,015 - INFO - Task started. Task ID: 57165
2025-08-12 14:24:03,343 - INFO - Report status: Created (attempt 1)
2025-08-12 14:24:06,622 - INFO - Report Completed
2025-08-12 14:24:28,238 - ERROR - Exception getting report data: ('Connection aborted.', ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2025-08-12 14:24:28,238 - INFO - Processing report 4/6: WarehouseLocations
2025-08-12 14:24:28,239 - INFO - Processing report: WarehouseLocations
2025-08-12 14:24:47,436 - ERROR - Exception starting report task: ('Connection aborted.', ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2025-08-12 14:24:47,436 - INFO - Processing report 5/6: Shipping Report
2025-08-12 14:24:47,437 - INFO - Processing report: Shipping Report
2025-08-12 14:25:06,636 - ERROR - Exception starting report task: ('Connection aborted.', ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2025-08-12 14:25:06,637 - INFO - Processing report 6/6: Pull Manifest report
2025-08-12 14:25:06,637 - INFO - Processing report: Pull Manifest report
2025-08-12 14:25:25,814 - ERROR - Exception starting report task: ('Connection aborted.', ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2025-08-12 14:25:25,815 - INFO - ==================================================
2025-08-12 14:25:25,815 - INFO - Pipeline Summary:
2025-08-12 14:25:25,815 - INFO - Successful reports: 2 / 6
2025-08-12 14:25:25,815 - INFO - Completed at: 2025-08-12 14:25:25
2025-08-12 14:25:25,815 - INFO - ==================================================
2025-08-12 14:25:25,815 - ERROR - Pipeline completed with errors!
