2025-10-09 09:55:21,958 - INFO - Logging initialized. Log file: logs\pipeline_20251009_095521.log
2025-10-09 09:55:21,958 - INFO - ==================================================
2025-10-09 09:55:21,958 - INFO - Starting Veracore Data Pipeline
2025-10-09 09:55:21,958 - INFO - Execution time: 2025-10-09 09:55:21
2025-10-09 09:55:21,959 - INFO - ==================================================
2025-10-09 09:55:21,959 - INFO - All required environment variables are set.
2025-10-09 09:55:21,959 - INFO - ==================================================
2025-10-09 09:55:21,959 - INFO - ARCHIVING EXISTING CSV FILES
2025-10-09 09:55:21,959 - INFO - ==================================================
2025-10-09 09:55:21,959 - INFO - ARCHIVE: SHAREPOINT_URL = https://3plwinner.sharepoint.com
2025-10-09 09:55:21,959 - INFO - ARCHIVE: SHAREPOINT_FOLDER = /sites/3PLWINNER/Shared Documents/InventoryHealthDashboard
2025-10-09 09:55:21,960 - INFO - ARCHIVE: SHAREPOINT_CLIENT_ID = SET
2025-10-09 09:55:21,960 - INFO - ARCHIVE: SHAREPOINT_CLIENT_SECRET = SET
2025-10-09 09:55:21,960 - INFO - ARCHIVE: Starting archive process for folder: /sites/3PLWINNER/Shared Documents/InventoryHealthDashboard
2025-10-09 09:55:22,742 - INFO - ARCHIVE: Connected to site: 3PLWinner
2025-10-09 09:55:22,890 - ERROR - ARCHIVE: Critical error: ('-2147024894, System.IO.FileNotFoundException', 'File Not Found.', "404 Client Error: Not Found for url: https://3plwinner.sharepoint.com/_api/Web/getFolderByServerRelativeUrl('%2Fsites%2F3PLWINNER%2FShared%20Documents%2FInventoryHealthDashboard')")
2025-10-09 09:55:22,893 - ERROR - ARCHIVE: Traceback: Traceback (most recent call last):
  File "C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\env\Lib\site-packages\office365\runtime\client_request.py", line 83, in execute_query
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://3plwinner.sharepoint.com/_api/Web/getFolderByServerRelativeUrl('%2Fsites%2F3PLWINNER%2FShared%20Documents%2FInventoryHealthDashboard')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\reports.py", line 133, in archive_existing_csvs
    ctx.execute_query()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\env\Lib\site-packages\office365\runtime\client_runtime_context.py", line 133, in execute_query
    self.pending_request().execute_query()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\jannatipour.leena\Downloads\InventoryHealthDashboard_DATA-6\env\Lib\site-packages\office365\runtime\client_request.py", line 87, in execute_query
    raise ClientRequestException(*e.args, response=e.response)
office365.runtime.client_request_exception.ClientRequestException: ('-2147024894, System.IO.FileNotFoundException', 'File Not Found.', "404 Client Error: Not Found for url: https://3plwinner.sharepoint.com/_api/Web/getFolderByServerRelativeUrl('%2Fsites%2F3PLWINNER%2FShared%20Documents%2FInventoryHealthDashboard')")

2025-10-09 09:55:22,893 - WARNING - ==================================================
2025-10-09 09:55:22,894 - WARNING - ARCHIVING HAD ISSUES
2025-10-09 09:55:22,894 - WARNING - ==================================================
2025-10-09 09:55:22,895 - INFO - Attempting to get authorization token from VeraCore API
2025-10-09 09:55:22,895 - INFO - USERNAME: SET
2025-10-09 09:55:22,896 - INFO - PASSWORD: SET
2025-10-09 09:55:22,896 - INFO - SYSTEM_ID: SET
2025-10-09 09:55:22,896 - INFO - W_TOKEN: SET
2025-10-09 09:55:22,897 - INFO - USERNAME value: jannatipour.leena
2025-10-09 09:55:22,897 - INFO - SYSTEM_ID value: 3plwhs
2025-10-09 09:55:22,897 - INFO - Attempting direct token authentication...
2025-10-09 09:55:22,897 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2025-10-09 09:55:23,157 - INFO - Direct token test - Status Code: 200
2025-10-09 09:55:23,158 - INFO - Direct token test - Response Headers: {'Date': 'Thu, 09 Oct 2025 16:55:22 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s1; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '98bf67bf3f437bad-LAX'}
2025-10-09 09:55:23,158 - INFO - âœ“ Direct token authentication successful!
2025-10-09 09:55:23,159 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
